class n{onekoEl;onekoPosX;onekoPosY;mousePosX;mousePosY;frameCount;idleTime;idleAnimation;idleAnimationFrame;onekoSpeed;lastFrameTimestamp;spriteSets;onekoFile;constructor(i){this.onekoEl=document.createElement("div"),this.onekoPosX=1350,this.onekoPosY=600,this.mousePosX=1350,this.mousePosY=600,this.frameCount=0,this.idleTime=0,this.idleAnimation=null,this.idleAnimationFrame=0,this.onekoSpeed=10,this.lastFrameTimestamp=null,this.onekoFile=i,this.spriteSets={idle:[[-3,-3]],alert:[[-7,-3]],scratchSelf:[[-5,0],[-6,0],[-7,0]],scratchWallN:[[0,0],[0,-1]],scratchWallS:[[-7,-1],[-6,-2]],scratchWallE:[[-2,-2],[-2,-3]],scratchWallW:[[-4,0],[-4,-1]],tired:[[-3,-2]],sleeping:[[-2,0],[-2,-1]],N:[[-1,-2],[-1,-3]],NE:[[0,-2],[0,-3]],E:[[-3,0],[-3,-1]],SE:[[-5,-1],[-5,-2]],S:[[-6,-3],[-7,-2]],SW:[[-5,-3],[-6,-1]],W:[[-4,-2],[-4,-3]],NW:[[-1,0],[-1,-1]]},this.init()}init(){this.onekoEl.ariaHidden="true",this.onekoEl.style.width="32px",this.onekoEl.style.height="32px",this.onekoEl.style.position="fixed",this.onekoEl.style.pointerEvents="none",this.onekoEl.style.imageRendering="pixelated",this.onekoEl.style.left=`${this.onekoPosX-16}px`,this.onekoEl.style.top=`${this.onekoPosY-16}px`,this.onekoEl.style.zIndex="-2147483647",this.onekoEl.style.backgroundImage=`url(${this.onekoFile})`,document.body.appendChild(this.onekoEl),document.addEventListener("pointermove",i=>{this.mousePosX=i.clientX,this.mousePosY=i.clientY,this.onekoEl.style.zIndex="2147483647"}),window.requestAnimationFrame(this.onAnimationFrame.bind(this))}onAnimationFrame(i){this.onekoEl.isConnected&&(this.lastFrameTimestamp||(this.lastFrameTimestamp=i),i-this.lastFrameTimestamp>100&&(this.lastFrameTimestamp=i,this.frame()),window.requestAnimationFrame(this.onAnimationFrame.bind(this)))}setSprite(i,t){const e=this.spriteSets[i][t%this.spriteSets[i].length];this.onekoEl.style.backgroundPosition=`${e[0]*32}px ${e[1]*32}px`}resetIdleAnimation(){this.idleAnimation=null,this.idleAnimationFrame=0}idle(){if(this.idleTime+=1,this.idleTime>10&&Math.random()<.005&&!this.idleAnimation){const i=["sleeping","scratchSelf"];this.onekoPosX<32&&i.push("scratchWallW"),this.onekoPosY<32&&i.push("scratchWallN"),this.onekoPosX>window.innerWidth-32&&i.push("scratchWallE"),this.onekoPosY>window.innerHeight-32&&i.push("scratchWallS"),this.idleAnimation=i[Math.floor(Math.random()*i.length)]}switch(this.idleAnimation){case"sleeping":this.idleAnimationFrame<8?this.setSprite("tired",0):this.setSprite("sleeping",Math.floor(this.idleAnimationFrame/4)),this.idleAnimationFrame>192&&this.resetIdleAnimation();break;case"scratchWallN":case"scratchWallS":case"scratchWallE":case"scratchWallW":case"scratchSelf":this.setSprite(this.idleAnimation,this.idleAnimationFrame),this.idleAnimationFrame>9&&this.resetIdleAnimation();break;default:this.setSprite("idle",0)}this.idleAnimationFrame+=1}frame(){this.frameCount+=1;const i=this.onekoPosX-this.mousePosX,t=this.onekoPosY-this.mousePosY,e=Math.sqrt(i*i+t*t);if(e<this.onekoSpeed||e<32){this.idle();return}if(this.idleAnimation=null,this.idleAnimationFrame=0,this.idleTime>1){this.setSprite("alert",0),this.idleTime=Math.min(this.idleTime,7),this.idleTime-=1;return}let s="";s+=t/e>.5?"N":"",s+=t/e<-.5?"S":"",s+=i/e>.5?"W":"",s+=i/e<-.5?"E":"",this.setSprite(s,this.frameCount),this.onekoPosX-=i/e*this.onekoSpeed,this.onekoPosY-=t/e*this.onekoSpeed,this.onekoPosX=Math.min(Math.max(16,this.onekoPosX),window.innerWidth-16),this.onekoPosY=Math.min(Math.max(16,this.onekoPosY),window.innerHeight-16),this.onekoEl.style.left=`${this.onekoPosX-16}px`,this.onekoEl.style.top=`${this.onekoPosY-16}px`}}export{n as default};
